<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta name="description" content="">
		<title></title>
		<link rel="stylesheet" href="demo-styles.css">

		<script type="module">
		import "./islands.js";

		// You can directly import dependencies (for eager loading)
		// or for lazy loaded islands put dependencies into `import="./vanilla-web-component"`
		import "./thirdparty-web-component.js";

		// alternatively, you can `import { ready } from "@11ty/island";` and `await ready(el)` in your component code
		import "./vanilla-web-component.js";
		</script>
	</head>
	<body>
		<h1><a href="/demo.html">is-land</a></h1>

		<p>A framework independent partial hydration islands architecture implementation using web components.</p>
		<p>Features:</p>

		<ul>
			<li>Easy to add to existing components</li>
			<li>Zero dependencies by default</li>
			<li>Small footprint</li>
			<li>Not tightly coupled to a server framework or site generator tool.</li>
		</ul>

		<p>Examples:</p>
		<ul>
			<li>Web Components, Vue, and <code>petite-vue</code> (on this page)</li>
			<li><a href="demo-lit.html">Lit</a></li>
			<li><a href="demo-importmaps.html">Using import maps to simplify import URLs</a> (this is a for-future-reference feature when <a href="https://caniuse.com/import-maps">browser support broadens</a>)
		</ul>

		<h2>Standalone</h2>

		<p>This is a control to make sure the component initializes as expected without an island.</p>

		<vanilla-web-component>Vanilla web component</vanilla-web-component>

		<h2>Defaults</h2>

		<p>These islands are eagerly loaded and initialized.</p>

		<is-land>
			<vanilla-web-component>Vanilla web component</vanilla-web-component>
		</is-land>

		<is-land autoinit="petite-vue" import="https://unpkg.com/petite-vue@0.4.1/dist/petite-vue.es.js" v-scope="{ count: 0 }">
			Petite Vue:
			<button @click="count++">⬆️</button>
			<button @click="count--">⬇️</button>
			<span v-html="count">0</span>
		</is-land>

		<is-land>
			<div id="petite-vue-app">
				Petite Vue (using an inline script for extra init code):
				<button @click="count++">⬆️</button>
				<button @click="count--">⬇️</button>
				<span v-html="count">0</span>
			</div>

			<!-- because this is eagerly loaded we want `type="module"` instead of `type="module/island"` so the preload scanner can find it-->
			<script type="module">
			import { createApp } from "https://unpkg.com/petite-vue@0.4.1/dist/petite-vue.es.js";

			createApp({
				count: 0,
			}).mount("#petite-vue-app")
			</script>
		</is-land>

		<h2>Scroll down</h2>

		<hr style="height: 100vh">

		<h2><code>on:visible</code></h2>
		<is-land on:visible>
			<vanilla-web-component>Vanilla web component</vanilla-web-component>
		</is-land>

		<is-land autoinit="petite-vue" import="https://unpkg.com/petite-vue@0.4.1/dist/petite-vue.es.js" on:visible v-scope="{ count: 0 }">
			Petite Vue:
			<button @click="count++">⬆️</button>
			<button @click="count--">⬇️</button>
			<span v-html="count">0</span>
		</is-land>

		<!-- You can add `import="https://unpkg.com/petite-vue@0.4.1/dist/petite-vue.es.js"` here if you want the import to finish before the component is declared “ready” -->
		<is-land on:visible>
			<div id="petite-vue-app-visible">
				Petite Vue (using an inline script for extra init code):
				<button @click="count++">⬆️</button>
				<button @click="count--">⬇️</button>
				<span v-html="count">0</span>
			</div>

			<script type="module/island">
				import { createApp } from "https://unpkg.com/petite-vue@0.4.1/dist/petite-vue.es.js";

				createApp({
					count: 0,
				}).mount("#petite-vue-app-visible")
			</script>
		</is-land>

		<h3>Lazy loaded Vue.js</h3>

		<p>This is the first full Vue component (and it is off-viewport) so the library code is also lazy loaded. You can swap this behavior and eagerly load the library code by adding <code>loading="eager"</code> on any individual island.</p>

		<!-- You can add `import="https://unpkg.com/vue@3.2.36/dist/vue.esm-browser.prod.js"` here if you want the import to finish before the component is declared “ready” -->
		<is-land on:visible>
			<div id="vue-app">
				Vue (using an inline script for extra init code):
				<button @click="count++">⬆️</button>
				<button @click="count--">⬇️</button>
				<span v-html="count">0</span>
			</div>

			<script type="module/island">
				import { createApp } from "https://unpkg.com/vue@3.2.36/dist/vue.esm-browser.prod.js";

				createApp({
					data() {
						return { count: 0 };
					}
				}).mount("#vue-app")
			</script>
		</is-land>

		<h3>Works with &lt;details&gt;</h3>
		<details>
			<summary>The child content in this &lt;details&gt; will not be initialized until you open it</summary>

			<is-land on:visible>
				<vanilla-web-component>Vanilla web component</vanilla-web-component>

				<is-land autoinit="petite-vue" import="https://unpkg.com/petite-vue@0.4.1/dist/petite-vue.es.js" v-scope="{ count: 0 }">
					Petite Vue:
					<button @click="count++">⬆️</button>
					<button @click="count--">⬇️</button>
					<span v-html="count">0</span>
				</is-land>
			</is-land>
		</details>

		<h2><code>on:visible</code> nested group</h2>

		<p>Parent island has <code>on:visible</code> but none of the child components have an explicit loading condition. They will inherit the loading conditions of all of the ancestors.</p>

		<is-land on:visible>
			<vanilla-web-component>Vanilla web component</vanilla-web-component>

			<is-land autoinit="petite-vue" import="https://unpkg.com/petite-vue@0.4.1/dist/petite-vue.es.js" v-scope="{ count: 0 }">
				Petite Vue:
				<button @click="count++">⬆️</button>
				<button @click="count--">⬇️</button>
				<span v-html="count">0</span>
			</is-land>
		</is-land>

		<h2><code>on:idle</code></h2>

		<is-land autoinit="petite-vue" import="https://unpkg.com/petite-vue@0.4.1/dist/petite-vue.es.js" on:idle v-scope="{ count: 0 }">
			Petite Vue:
			<button @click="count++">⬆️</button>
			<button @click="count--">⬇️</button>
			<span v-html="count">0</span>
		</is-land>
		<is-land autoinit="petite-vue" import="https://unpkg.com/petite-vue@0.4.1/dist/petite-vue.es.js" on:idle v-scope="{ count: 0 }">
			Petite Vue:
			<button @click="count++">⬆️</button>
			<button @click="count--">⬇️</button>
			<span v-html="count">0</span>
		</is-land>
		<is-land autoinit="petite-vue" import="https://unpkg.com/petite-vue@0.4.1/dist/petite-vue.es.js" on:idle v-scope="{ count: 0 }">
			Petite Vue:
			<button @click="count++">⬆️</button>
			<button @click="count--">⬇️</button>
			<span v-html="count">0</span>
		</is-land>
		<is-land autoinit="petite-vue" import="https://unpkg.com/petite-vue@0.4.1/dist/petite-vue.es.js" on:idle v-scope="{ count: 0 }">
			Petite Vue:
			<button @click="count++">⬆️</button>
			<button @click="count--">⬇️</button>
			<span v-html="count">0</span>
		</is-land>
		<is-land autoinit="petite-vue" import="https://unpkg.com/petite-vue@0.4.1/dist/petite-vue.es.js" on:idle v-scope="{ count: 0 }">
			Petite Vue:
			<button @click="count++">⬆️</button>
			<button @click="count--">⬇️</button>
			<span v-html="count">0</span>
		</is-land>
		<is-land autoinit="petite-vue" import="https://unpkg.com/petite-vue@0.4.1/dist/petite-vue.es.js" on:idle v-scope="{ count: 0 }">
			Petite Vue:
			<button @click="count++">⬆️</button>
			<button @click="count--">⬇️</button>
			<span v-html="count">0</span>
		</is-land>
		<is-land autoinit="petite-vue" import="https://unpkg.com/petite-vue@0.4.1/dist/petite-vue.es.js" on:idle v-scope="{ count: 0 }">
			Petite Vue:
			<button @click="count++">⬆️</button>
			<button @click="count--">⬇️</button>
			<span v-html="count">0</span>
		</is-land>
		<is-land autoinit="petite-vue" import="https://unpkg.com/petite-vue@0.4.1/dist/petite-vue.es.js" on:idle v-scope="{ count: 0 }">
			Petite Vue:
			<button @click="count++">⬆️</button>
			<button @click="count--">⬇️</button>
			<span v-html="count">0</span>
		</is-land>
		<is-land autoinit="petite-vue" import="https://unpkg.com/petite-vue@0.4.1/dist/petite-vue.es.js" on:idle v-scope="{ count: 0 }">
			Petite Vue:
			<button @click="count++">⬆️</button>
			<button @click="count--">⬇️</button>
			<span v-html="count">0</span>
		</is-land>
		<is-land autoinit="petite-vue" import="https://unpkg.com/petite-vue@0.4.1/dist/petite-vue.es.js" on:idle v-scope="{ count: 0 }">
			Petite Vue:
			<button @click="count++">⬆️</button>
			<button @click="count--">⬇️</button>
			<span v-html="count">0</span>
		</is-land>
		<is-land autoinit="petite-vue" import="https://unpkg.com/petite-vue@0.4.1/dist/petite-vue.es.js" on:idle v-scope="{ count: 0 }">
			Petite Vue:
			<button @click="count++">⬆️</button>
			<button @click="count--">⬇️</button>
			<span v-html="count">0</span>
		</is-land>
		<is-land autoinit="petite-vue" import="https://unpkg.com/petite-vue@0.4.1/dist/petite-vue.es.js" on:idle v-scope="{ count: 0 }">
			Petite Vue:
			<button @click="count++">⬆️</button>
			<button @click="count--">⬇️</button>
			<span v-html="count">0</span>
		</is-land>

		<h2><code>on:interaction</code> nested group</h2>

		<p>Requires one of: touchstart, click.</p>
		<p>Note here that we used one parent island to group both of these components, and interacting with either initializes the whole group.</p>

		<is-land on:interaction>
			<is-land autoinit="petite-vue" import="https://unpkg.com/petite-vue@0.4.1/dist/petite-vue.es.js" v-scope="{ count: 0 }">
				Petite Vue:
				<button @click="count++">⬆️</button>
				<button @click="count--">⬇️</button>
				<span v-html="count">0</span>
			</is-land>

			<vanilla-web-component>Vanilla web component</vanilla-web-component>
		</is-land>

		<p>Use <code>on:interaction="mouseenter,focusin"</code> to override the events.</p>
		<is-land on:interaction="mouseenter,focusin">
			<is-land autoinit="petite-vue" import="https://unpkg.com/petite-vue@0.4.1/dist/petite-vue.es.js" v-scope="{ count: 0 }">
				Petite Vue:
				<button @click="count++">⬆️</button>
				<button @click="count--">⬇️</button>
				<span v-html="count">0</span>
			</is-land>

			<vanilla-web-component>Vanilla web component</vanilla-web-component>
		</is-land>

		<h2><code>on:media</code></h2>
		<h3>Viewport size</h3>
		<p><code>on:media="(min-width: 64em)"</code></p>
		<p>This only runs when the viewport is greater than or equal to 1024px wide: <code>on:media="(min-width: 64em)"</code></p>
		<is-land autoinit="petite-vue" import="https://unpkg.com/petite-vue@0.4.1/dist/petite-vue.es.js" on:media="(min-width: 64em)" v-scope="{ count: 0 }">
			Petite Vue:
			<button @click="count++">⬆️</button>
			<button @click="count--">⬇️</button>
			<span v-html="count">0</span>
		</is-land>
		
		<p>This only runs when the viewport is less than 1024px wide: <code>on:media="(max-width: 63.9375em)"</code></p>
		<is-land autoinit="petite-vue" import="https://unpkg.com/petite-vue@0.4.1/dist/petite-vue.es.js" on:media="(max-width: 63.9375em)" v-scope="{ count: 0 }">
			Petite Vue:
			<button @click="count++">⬆️</button>
			<button @click="count--">⬇️</button>
			<span v-html="count">0</span>
		</is-land>

		<h3>Reduced Motion</h3>
		<p>This runs when the user prefers reduced motion: <code>on:media="(prefers-reduced-motion)"</code></p>
		
		<is-land on:media="(prefers-reduced-motion)">
			<vanilla-web-component>Vanilla web component</vanilla-web-component>
		</is-land>

		<p>This runs when does not have a reduced motion preference: <code>on:media="(prefers-reduced-motion: no-preference)"</code></p>

		<is-land on:media="(prefers-reduced-motion: no-preference)">
			<vanilla-web-component>Vanilla web component</vanilla-web-component>
		</is-land>

		<h2><code>on:save-data</code></h2>

		<p>This runs when the user has <a href="https://developer.mozilla.org/en-US/docs/Web/API/NetworkInformation/saveData">Save Data</a> enabled:</p>

		<is-land on:save-data>
			<vanilla-web-component>Vanilla web component</vanilla-web-component>
		</is-land>

		<p><code>on:save-data="false"</code> This runs when the user does not have <a href="https://developer.mozilla.org/en-US/docs/Web/API/NetworkInformation/saveData">Save Data</a> enabled:</p>

		<is-land on:save-data="false">
			<vanilla-web-component>Vanilla web component</vanilla-web-component>
		</is-land>

		<h2>Fallback content</h2>

		<p>If you put child content in a &lt;template&gt; it will be JavaScript-only (no fallback). This doesn’t need to be all or nothing. You can mix and match &lt;template&gt; with other progressively enhanced content in the island.</p>

		<p>In this example, disabling JavaScript will only show the content in the vanilla web component.</p>

		<is-land on:visible>
			<vanilla-web-component>Vanilla web component (available without JS)</vanilla-web-component>
			
			<template data-island>
				<is-land autoinit="petite-vue" import="https://unpkg.com/petite-vue@0.4.1/dist/petite-vue.es.js" v-scope="{ count: 0 }">
					Petite Vue (in a JS-only &lt;template&gt;):
					<button @click="count++">⬆️</button>
					<button @click="count--">⬇️</button>
					<span v-html="count">0</span>
				</is-land>
			</template>

			<vanilla-web-component>
				Vanilla web component (available without JS)

				<template data-island>
					<is-land autoinit="petite-vue" import="https://unpkg.com/petite-vue@0.4.1/dist/petite-vue.es.js" v-scope="{ count: 0 }">
						Petite Vue (nested in the web component in a JS-only &lt;template&gt;):
						<button @click="count++">⬆️</button>
						<button @click="count--">⬇️</button>
						<span v-html="count">0</span>
					</is-land>
				</template>
			</vanilla-web-component>
		</is-land>

		<h3>Use <code>fallback</code> with third-party components</h3>

		<p>When using third party components, you aren’t able to make changes to the component code but still want lazy initialization! While you could put these into a &lt;template&gt; as shown above to hide fallback content, using <code>fallback</code> allows both lazy initialization and fallback content.</p>

		<is-land on:visible fallback>
			<thirdparty-web-component custom-attribute some other attributes>
				Bare bones web component 1a
				<thirdparty-web-component>Bare bones web component 1b</thirdparty-web-component>
				Bare bones web component 1c
				<thirdparty-web-component>Bare bones web component 1d</thirdparty-web-component>
			</thirdparty-web-component>
			<p>Testing A</p>
			<thirdparty-web-component>Bare bones web component 2</thirdparty-web-component>
			<p>Testing B</p>
			<thirdparty-web-component>Bare bones web component 3</thirdparty-web-component>
		</is-land>

		<h4><code>fallback on:interaction</code></h4>

		<p>In this example we use a third party web component (<a href="https://github.com/zachleat/details-utils">&lt;details-utils&gt;</a>) without any code changes made to the component. Note that children here are maintained before and after initialization (e.g. click the summary to expand before init and it keeps that state after init).</p>
	
		<is-land on:interaction fallback imports="./lib/details-utils.js">
			<button type="button" onclick="console.log('Click test')">Click test (log to console)</button>

			<details-utils close-click-outside>
				<details open>
					<summary>Toggle Menu (Default open: click outside to close after island initializes)</summary>
					<p>Note that interacting with content inside of the menu works without closing the menu.</p>
				</details>

				<details>
					<summary>Toggle Menu (Default closed: will toggle before island initializes)</summary>
					<p>Note that interacting with content inside of the menu works without closing the menu.</p>
				</details>
			</details-utils>
		</is-land>

		<h4>Pass in a selector for to progressively enhance other elements (<code>fallback="img" on:interaction</code>)</h4>
		<p>This example uses <code>on:interaction</code> so you need to interact with the island for the image to load. Note the aspect ratio before/after is preserved via the width/height attributes on the img.</p>
		<is-land on:interaction fallback="img">
			<form>
				<button type="button">Load the image</button>
			</form>
			<img src="lib/logo-bg.svg" loading="lazy" width="200" height="200">
		</is-land>
	</body>
</html>